<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.png">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Lato', 'Microsoft Yahei Light:300,300italic,400,400italic,700,700italic|Cambria', 'Microsoft Yahei Light:300,300italic,400,400italic,700,700italic|Verdana', Lato, 'Microsoft Yahei Light:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Problem 653 Frictionless TubeConsider a horizontal frictionless tube with length $L$ millimetres, and a diameter of $20$ millimetres. The east end of the tube is open, while the west end is sealed. T">
<meta property="og:type" content="article">
<meta property="og:title" content="Problem 653">
<meta property="og:url" content="http://yoursite.com/653/index.html">
<meta property="og:site_name" content="Project Euler | 欧拉计划">
<meta property="og:description" content="Problem 653 Frictionless TubeConsider a horizontal frictionless tube with length $L$ millimetres, and a diameter of $20$ millimetres. The east end of the tube is open, while the west end is sealed. T">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-01-27T01:00:00.000Z">
<meta property="article:modified_time" content="2020-10-06T05:48:55.059Z">
<meta property="article:author" content="sx349">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/653/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Problem 653 | Project Euler | 欧拉计划</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Project Euler | 欧拉计划</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-problem">

    <a href="/problems" rel="section"><i class="fa fa-tags fa-fw"></i>题目</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/653/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="sx349">
      <meta itemprop="description" content="Project Euler | 欧拉计划 中文翻译站">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Project Euler | 欧拉计划">
    </span>
      <footer class="post-footer">
        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/652/" rel="prev" title="Problem 652">
      <i class="fa fa-chevron-left"></i> Problem 652
    </a></div>
      <div class="post-nav-item">
    <a href="/654/" rel="next" title="Problem 654">
      Problem 654 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Problem 653
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">题目发布于</span>

              <time title="发布时间：2019-01-27 01:00:00" itemprop="dateCreated datePublished" datetime="2019-01-27T01:00:00+00:00">2019-01-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">翻译更新于</span>
                <time title="更新时间：2020-10-06 06:48:55" itemprop="dateModified" datetime="2020-10-06T06:48:55+01:00">2020-10-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <hr>
<h1 id="Problem-653"><a href="#Problem-653" class="headerlink" title="Problem 653"></a><a href="https://projecteuler.net/problem=653">Problem 653</a></h1><hr>
<h2 id="Frictionless-Tube"><a href="#Frictionless-Tube" class="headerlink" title="Frictionless Tube"></a><strong>Frictionless Tube</strong></h2><p>Consider a horizontal frictionless tube with length $L$ millimetres, and a diameter of $20$ millimetres. The east end of the tube is open, while the west end is sealed. The tube contains $N$ marbles of diameter $20$ millimetres at designated starting locations, each one initially moving either westward or eastward with common speed $v$.</p>
<p>Since there are marbles moving in opposite directions, there are bound to be some collisions. We assume that the collisions are perfectly elastic, so both marbles involved instantly change direction and continue with speed  $v$ away from the collision site. Similarly, if the west-most marble collides with the sealed end of the tube, it instantly changes direction and continues eastward at speed $v$. On the other hand, once a marble reaches the unsealed east end, it exits the tube and has no further interaction with the remaining marbles.</p>
<p>To obtain the starting positions and initial directions, we use the pseudo-random sequence $r_j$ defined by:<br>$r_1 = 6\ 563\ 116$<br>$r_{j+1}=r^2_j\mod 32\ 745\ 673$<br>The west-most marble is initially positioned with a gap of $(r_1 \mod 1000)+1$ millimetres between it and the sealed end of the tube, measured from the west-most point of the surface of the marble. Then, for $2\le j\le N$, counting from the west, the gap between the $(j-1)$th and $j$th marbles, as measured from their closest points, is given by $(r_j\mod 1000)+1$ millimetres. Furthermore, the $j$th marble is initially moving eastward if $r_j\le 10\ 000\ 000$, and westward if $r_j&gt;10\ 000\ 000$.</p>
<p>For example, with $N=3$, the sequence specifies gaps of $117$, $432$, and $173$ millimetres. The marbles’ <i>centres</i> are therefore $127$, $579$, and $772$ millimetres from the sealed west end of the tube. The west-most marble initially moves eastward, while the other two initially move westward.</p>
<p>Under this setup, and with a five metre tube ($L=5000$), it turns out that the middle (second) marble travels $5519$ millimetres before its centre reaches the east-most end of the tube.</p>
<p>Let $d(L,N,j)$ be the distance in millimetres that the $j$th marble travels before its centre reaches the eastern end of the tube. So $d(5000,3,2)=5519$. You are also given that $d(10\ 000,11,6)=11\ 780$ and $d(100\ 000,101,51)=114\ 101$.</p>
<p>Find $d(1\ 000\ 000\ 000, 1\ 000\ 001, 500\ 001)$.</p>
<hr>
<h2 id="无摩擦管道"><a href="#无摩擦管道" class="headerlink" title="无摩擦管道"></a><strong>无摩擦管道</strong></h2><p>现有一根长为$L$毫米、直径为$20$毫米、水平放置的无摩擦管道，其东侧末端开口，西侧末端封闭。管道中放有$N$颗直径为$20$毫米的弹珠，这些弹珠放在指定的起始位置，并以相同的速率$v$向东或向西运动。</p>
<p>由于这些弹珠朝着相反方向运动，因此必然会发生碰撞。我们假设这些碰撞是完全弹性的，也就是说，弹珠相撞后立即向反方向运动且保持速率$v$不变。类似地，向西运动的弹珠如果撞到西侧封闭的末端，也会立即向东运动且保持速率$v$不变。反之，如果弹珠抵达了东侧开口的末端，它会离开管道，不再需要考虑。</p>
<p>这些弹珠的起始位置和最初的运动方向由如下伪随机数列$r_j$确定：<br>$r_1 = 6\ 563\ 116$<br>$r_{j+1}=r^2_j\mod 32\ 745\ 673$<br>最靠西的弹珠最初被摆在其表面上最西侧的点距离管道被封闭的西侧末端$(r_1 \mod 1000)+1$毫米的位置上。随后继续从西到东摆放弹珠，对于$2\le j\le N$，第$(j-1)$颗和第$j$颗弹珠表面之间最接近的两点距离恰好是$(r_j\mod 1000)+1$毫米。此外，如果$r_j\le 10\ 000\ 000$，则第$j$颗弹珠向东运动，反之如果$r_j&gt;10\ 000\ 000$则向西运动。</p>
<p>例如，若$N=3$，弹珠间的距离分别是$117$、$432$和$173$毫米，也就是说，这些弹珠的<i>球心</i>分别位于距离管道西侧末端$127$、$579$和$772$毫米处。最靠西侧的弹珠一开始向东运动，而另外两颗弹珠则向西运动。</p>
<p>在上述设定下，如果管道的长度为五米（$L=5000$），那么中间那颗（第二颗）弹珠在其球心从东侧开口末端离开管道前，一共运动了$5519$毫米的距离。</p>
<p>记$d(L,N,j)$为第$j$颗弹珠在其球心从东侧开口末端离开管道前所运动的距离（以毫米计），因此$d(5000,3,2)=5519$。已知$d(10\ 000,11,6)=11\ 780$，$d(100\ 000,101,51)=114\ 101$。</p>
<p>求$d(1\ 000\ 000\ 000, 1\ 000\ 001, 500\ 001)$。</p>
<hr>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/652/" rel="prev" title="Problem 652">
      <i class="fa fa-chevron-left"></i> Problem 652
    </a></div>
      <div class="post-nav-item">
    <a href="/654/" rel="next" title="Problem 654">
      Problem 654 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Problem-653"><span class="nav-text">Problem 653</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Frictionless-Tube"><span class="nav-text">Frictionless Tube</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A0%E6%91%A9%E6%93%A6%E7%AE%A1%E9%81%93"><span class="nav-text">无摩擦管道</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="sx349"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Leonhard Euler(1707-1783)</p>
  <p class="site-description motion-element">Project Euler | 欧拉计划<br>中文翻译站</p>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-title">
          <a href="https://projecteuler.net/" title="https:&#x2F;&#x2F;projecteuler.net" rel="noopener" target="_blank">Project Euler</a>
        </li>
        <li class="links-of-blogroll-title">
          <a href="http://sx349.github.io/" title="http:&#x2F;&#x2F;sx349.github.io" rel="noopener" target="_blank">译者博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2001 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fas fa-calculator"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Project Euler | 欧拉计划</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
	  title       : document.title.substr(0,29),
      clientID    : '4ba99a8839c5e7dde683',
      clientSecret: '3984f7cad409553d6afde8dbc2c08fc425e7bbdc',
      repo        : 'pe-cn-comments',
      owner       : 'pe-cn',
      admin       : ['sx349'],
      id          : 'c6e53961309b2d07bcad02799888f14b',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
